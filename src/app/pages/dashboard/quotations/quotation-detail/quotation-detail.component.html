<div class="flex flex-col min-h-screen p-6 bg-gray-50 animate__animated animate__fadeIn">

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center py-20">
    <fa-icon [icon]="faSpinner" size="3x" class="text-purple-500 animate-spin"></fa-icon>
  </div>

  <!-- Error State -->
  <div *ngIf="!isLoading && error" class="flex flex-col items-center justify-center py-20">
    <fa-icon [icon]="faExclamationCircle" size="3x" class="text-red-500 mb-4"></fa-icon>
    <p class="text-red-500 text-center">{{ error }}</p>
  </div>

  <!-- Quotation Detail Content -->
  <div *ngIf="!isLoading && quotation && !error" class="space-y-6 animate__animated animate__fadeInUp">

    <!-- Summary Card matching Step 3 style -->
    <div class="bg-white rounded-lg shadow-md border border-gray-200 p-6">

      <!-- Company Logo and Info Header -->
      <div class="flex items-center justify-center mb-4">
        <img src="logo.png" alt="logo-advance" class="w-34 h-14 object-contain">
      </div>

      <div class="flex flex-col items-center mb-6">
        <p class="text-gray-700 font-semibold">Advance Technology Projects</p>
        <p class="text-gray-700">NIT - 900562155</p>
        <p class="text-gray-700 text-sm">www.advanceit.co</p>
      </div>

      <!-- Date and Status -->
      <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-200">
        <p class="text-gray-700">Hoy es {{ today }}</p>
        <span [class]="getStatusColor(quotation.status)" class="px-3 py-1 rounded-full text-sm font-semibold">
          {{ getStatusText(quotation.status) }}
        </span>
      </div>

      <!-- Quotation Data Section -->
      <h4 class="font-bold text-gray-700 mb-3">Los datos de la Cotización:</h4>
      <ul class="text-gray-600 space-y-2 mb-6">
        <li><strong>ID:</strong> {{ quotation.id }}</li>
        <li><strong>Razón Social:</strong> {{ company?.razon_social || 'N/A' }}</li>
        <li><strong>Usuario:</strong> {{ user?.name || user?.email || 'N/A' }}</li>
        <li><strong>Días de Validez:</strong> {{ quotation.validity_days }}</li>
        <li><strong>Fecha de vencimiento:</strong> {{ quotation.expiration_date | date:'longDate' }}</li>
        <li><strong>Término:</strong> {{ quotation.term }}</li>
        <li><strong>Tipo de pago:</strong> {{ quotation.company_id ? 'Cupo crédito' : 'Contado/Transferencia' }}</li>
      </ul>

      <!-- Products Section -->
      <h4 class="font-bold text-gray-700 mt-6 mb-3">Los productos de la cotización:</h4>
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm text-left text-gray-500">
          <thead class="text-xs text-gray-700 uppercase bg-gray-100">
            <tr>
              <th class="px-4 py-2">Producto ID</th>
              <th class="px-4 py-2">Cantidad</th>
              <th class="px-4 py-2">Precio Unitario</th>
              <th class="px-4 py-2">Subtotal</th>
              <th class="px-4 py-2">Impuestos</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let detail of quotation.details" class="bg-white border-b">
              <td class="px-4 py-2 text-ellipsis overflow-hidden whitespace-nowrap">{{ detail.product_id }}</td>
              <td class="px-4 py-2">{{ detail.quantity }}</td>
              <td class="px-4 py-2">${{ detail.unit_price | number:'1.2-2' }}</td>
              <td class="px-4 py-2">${{ detail.subtotal | number:'1.2-2' }}</td>
              <td class="px-4 py-2">${{ detail.taxes | number:'1.2-2' }}</td>
            </tr>
            <tr>
              <td colspan="4" class="px-4 py-2 font-bold text-right">Total:</td>
              <td class="px-4 py-2 font-bold text-purple-600 text-lg">${{ quotation.total | number:'1.2-2' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>