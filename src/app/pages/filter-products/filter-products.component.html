<div class="flex">
  <!-- Columna del Filtro (Izquierda) - Oculta en pantallas pequeñas -->
  <aside class="w-80 h-screen sticky top-0 hidden md:flex flex-col bg-white shadow-xl font-sans">

    <!-- Contenido del filtro -->
    <div class="flex flex-col flex-grow overflow-hidden mt-5">
      <!-- Toggle Categorías/Marcas -->
      <div class="flex p-2 border-b">
        <button (click)="setActiveView('categories')"
          [ngClass]="{ 'bg-purple-600 text-white shadow-md': activeView() === 'categories', 'bg-gray-100 text-gray-600 hover:bg-gray-200': activeView() !== 'categories' }"
          class="flex-1 p-2 rounded-md font-semibold text-sm transition-all duration-200 ease-in-out flex items-center justify-center gap-2">
          <fa-icon [icon]="faLayerGroup"></fa-icon> Categorías
        </button>
        <button (click)="setActiveView('brands')"
          [ngClass]="{ 'bg-purple-600 text-white shadow-md': activeView() === 'brands', 'bg-gray-100 text-gray-600 hover:bg-gray-200': activeView() !== 'brands' }"
          class="flex-1 p-2 rounded-md font-semibold text-sm transition-all duration-200 ease-in-out flex items-center justify-center gap-2">
          <fa-icon [icon]="faStar"></fa-icon> Marcas
        </button>
      </div>

      <!-- Vistas Deslizables -->
      <div class="relative flex-grow overflow-hidden">
        <!-- Vista de Categorías -->
        @if (activeView() === 'categories') {
        <div class="absolute w-full h-full transition-transform duration-300 ease-in-out"
          [ngClass]="{'translate-x-0': !currentCategory(), '-translate-x-full': currentCategory()}">
          <div class="p-4 h-full overflow-y-auto">
            <h2 class="text-xl font-bold text-purple-700 mb-4">Categorías</h2>
            <ul class="space-y-3">
              @for (category of categories(); track category.category) {
              <li (click)="selectCategory(category)"
                class="flex items-center justify-between p-3 bg-gray-50 hover:bg-purple-100 rounded-lg cursor-pointer transition-colors">
                <span class="flex items-center font-medium text-gray-800">
                  <fa-icon [icon]="faCopyright" class="mr-3 text-purple-600"></fa-icon> {{ category.category }}
                </span>
                <fa-icon [icon]="faChevronRight" class="text-gray-400"></fa-icon>
              </li>
              }
            </ul>
          </div>
        </div>
        <!-- Vista de Subcategorías -->
        <div class="absolute w-full h-full transition-transform duration-300 ease-in-out"
          [ngClass]="{'translate-x-0': currentCategory(), 'translate-x-full': !currentCategory()}">
          @if (currentCategory(); as selectedCat) {
          <div class="p-4 h-full overflow-y-auto">
            <button (click)="goBack()"
              class="mb-4 flex items-center text-purple-600 hover:text-purple-800 font-semibold">
              <fa-icon [icon]="faArrowLeft" class="mr-2"></fa-icon> Volver
            </button>
            <h2 (click)="onSelectCategory(selectedCat.category)"
              class="text-xl font-bold text-purple-700 mb-4 cursor-pointer hover:underline">
              {{ selectedCat.category }}
            </h2>
            <ul class="space-y-2">
              @for (sub of selectedCat.subCategories; track sub) {
              <li (click)="onSelectSubcategory(sub)"
                class="p-3 bg-gray-50 hover:bg-purple-100 rounded-lg cursor-pointer transition-colors text-gray-700">
                {{ sub }}
              </li>
              } @empty {
              <li class="p-2 text-gray-500">No hay subcategorías disponibles.</li>
              }
            </ul>
          </div>
          }
        </div>
        }
        <!-- Vista de Marcas -->
        @if (activeView() === 'brands') {
        <div class="absolute w-full h-full p-4 overflow-y-auto">
          <h2 class="text-xl font-bold text-purple-700 mb-4">Marcas</h2>
          <ul class="space-y-3">
            @for (brand of brands(); track brand.name) {
            <li (click)="onSelectBrand(brand.name)"
              class="flex items-center justify-between p-3 bg-gray-50 hover:bg-purple-100 rounded-lg cursor-pointer transition-colors">
              <span class="flex items-center font-medium text-gray-800 gap-3">
                <img class="h-8 object-contain w-10"
                  src="https://advanceit.co/assets/logos/{{ brand.name | lowercase }}.png"
                  alt="logo {{ brand.name | titlecase }}">
                {{ brand.name | titlecase }}
              </span>
              <span class="px-3 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-700">
                {{ brand.quantity }}
              </span>
            </li>
            }
          </ul>
        </div>
        }
      </div>
    </div>
  </aside>
<!-- 
  <div *ngIf="showBrandsMenu" (click)="onMenuBrands()" 
    class="bg-black/50 fixed top-0 z-50 w-full h-full flex overflow-hidden">
    <app-brand-menu (click)="$event.stopPropagation()"></app-brand-menu>
  </div> -->



  <!-- Columna de Contenido (Derecha) -->
  <main class="w-full p-6 bg-gray-50">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-700 to-orange-700">{{ viewTitle() }}</h1>
      <!-- Botón de filtro para móviles -->
      <button class="md:hidden p-2 rounded-md bg-purple-600 text-white">
        <fa-icon [icon]="faFilters"></fa-icon>
      </button>
    </div>

    <!-- Contenedor de Productos -->
    @if (products().length > 0) {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      @for (producto of products(); track producto.SKU) {
      <!-- Aquí usas tu componente de tarjeta de producto -->
      <app-product-advance [producto]="producto"></app-product-advance>
      }
    </div>
    }

    <!-- Estado de Carga (Skeleton) -->
    @if (isLoading()) {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      @for (item of [1,2,3,4]; track item) {
      <app-skeleton-filter-product></app-skeleton-filter-product>
      }
    </div>
    }

    <!-- No se encontraron productos -->
    @if (!isLoading() && products().length === 0) {
    <div class="text-center py-20">
      <p class="text-xl text-gray-500">No se encontraron productos con estos filtros.</p>
    </div>
    }

    <!-- Botón para Cargar Más -->
    @if (hasNextPage() && !isLoading()) {
    <div class="text-center mt-8">
      <button (click)="loadMoreProducts()"
        class="bg-purple-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-purple-700 transition-colors">
        Cargar más productos
      </button>
    </div>
    }
  </main>
</div>